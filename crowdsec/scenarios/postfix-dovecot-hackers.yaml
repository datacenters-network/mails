type: trigger
name: wdes/postfix-hackers
description: "Detect spammers"
filter: "evt.Meta.log_type == 'postfix' && evt.Meta.log_type_enh == 'non-SMTP-command-HTTP'"
groupby: evt.Meta.source_ip
blackhole: 1m
labels:
 service: postfix
 type: http-scan
 remediation: true
---
type: leaky
name: wdes/dovecot-hackers
description: "Detect user finding"
filter: "evt.Meta.log_type == 'dovecot_logs' && evt.Meta.dovecot_login_message == 'unknown user' && evt.Meta.IsoCode != 'FR'"
leakspeed: 10m
# Group by IP range
groupby: evt.Meta.SourceRange
# Will overflow after 2 attempts counted one each 1 second
distinct: evt.Meta.dovecot_user
capacity: 4
labels:
 service: dovecot
 type: user-bf
 remediation: true
